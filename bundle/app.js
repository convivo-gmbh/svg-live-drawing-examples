(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_live_drawing_1=require("svg-live-drawing");var LiveDrawApplication=function(_super){__extends(LiveDrawApplication,_super);function LiveDrawApplication(container){var _this=_super.call(this,container)||this;_this.gridActive=false;_this.grid=new svg_live_drawing_1.Grid;_this.grid.style="hidden";_this.backgroundLayer.addElement(_this.grid);_this.gridModifier=new svg_live_drawing_1.GridModifier(50);_this.gridModifier.enable(false);_this.controlFactory.afterCreateHook=function(control){control.addRestrictor(_this.gridModifier)};_this.toolManager.setWorkingLayer(_this.documentLayer);return _this}LiveDrawApplication.prototype.toggleGrid=function(){this.gridActive=!this.gridActive;this.gridModifier.enable(this.gridActive);this.grid.style=this.gridActive?"active":"hidden"};LiveDrawApplication.prototype.activateTool=function(toolName){this.toolManager.setTool(toolName);this.selectionManager.set(null)};return LiveDrawApplication}(svg_live_drawing_1.Application);exports.LiveDrawApplication=LiveDrawApplication},{"svg-live-drawing":41}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var live_draw_application_1=require("./live-draw-application");var button1=document.createElement("input");button1.type="button";button1.value="Draw Rectangle";document.body.appendChild(button1);var button2=document.createElement("input");button2.type="button";button2.value="Draw Circle";document.body.appendChild(button2);var button3=document.createElement("input");button3.type="button";button3.value="Draw Polygon";document.body.appendChild(button3);var button4=document.createElement("input");button4.type="button";button4.value="Toggle Grid";document.body.appendChild(button4);var container=document.createElement("div");document.body.appendChild(container);var app=new live_draw_application_1.LiveDrawApplication(container);button1.addEventListener("click",function(){app.activateTool("rectangleControl")},false);button2.addEventListener("click",function(){app.activateTool("circleControl")},false);button3.addEventListener("click",function(){app.activateTool("polygonControl")},false);button4.addEventListener("click",function(){app.toggleGrid()},false)},{"./live-draw-application":1}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var math_1=require("@daign/math");var schedule_1=require("@daign/schedule");var Handle=function(){function Handle(node){var _this=this;this._start=new math_1.Vector2;this._temp=new math_1.Vector2;this._delta=new math_1.Vector2;this.beginning=function(){return false};this.continuing=function(){};this.ending=function(){};this.clicked=function(){};this.node=node;this.node.addEventListener("mousedown",function(event){_this.beginDrag(event)},false);this.node.addEventListener("touchstart",function(event){_this.beginDrag(event)},false)}Object.defineProperty(Handle.prototype,"start",{get:function(){return this._start},enumerable:true,configurable:true});Object.defineProperty(Handle.prototype,"temp",{get:function(){return this._temp},enumerable:true,configurable:true});Object.defineProperty(Handle.prototype,"delta",{get:function(){return this._delta},enumerable:true,configurable:true});Handle.prototype.beginDrag=function(startEvent){var _this=this;startEvent.preventDefault();startEvent.stopPropagation();var dragged=false;this._start.setFromEvent(startEvent);if(this.beginning(startEvent)){var cancelSelect_1=function(selectEvent){selectEvent.preventDefault();selectEvent.stopPropagation()};var continueDrag=function(moveEvent){moveEvent.preventDefault();moveEvent.stopPropagation();dragged=true;_this._temp.setFromEvent(moveEvent);_this._delta.copy(_this._temp).sub(_this._start);_this.continuing()};var throttledContinue_1=schedule_1.Schedule.deferringThrottle(continueDrag,40,this);var endDrag_1=function(endEvent){endEvent.preventDefault();endEvent.stopPropagation();_this._temp.setFromEvent(endEvent);_this._delta.copy(_this._temp).sub(_this._start);if(dragged){_this.ending()}else{_this.clicked()}document.removeEventListener("selectstart",cancelSelect_1,false);document.removeEventListener("mousemove",throttledContinue_1,false);document.removeEventListener("touchmove",throttledContinue_1,false);document.removeEventListener("mouseup",endDrag_1,false);document.removeEventListener("touchend",endDrag_1,false);document.removeEventListener("touchcancel",endDrag_1,false);document.removeEventListener("touchleave",endDrag_1,false)};document.addEventListener("selectstart",cancelSelect_1,false);document.addEventListener("mousemove",throttledContinue_1,false);document.addEventListener("touchmove",throttledContinue_1,false);document.addEventListener("mouseup",endDrag_1,false);document.addEventListener("touchend",endDrag_1,false);document.addEventListener("touchcancel",endDrag_1,false);document.addEventListener("touchleave",endDrag_1,false)}};return Handle}();exports.Handle=Handle},{"@daign/math":7,"@daign/schedule":17}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var handle_1=require("./handle");exports.Handle=handle_1.Handle},{"./handle":3}],5:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var Angle=function(_super){__extends(Angle,_super);function Angle(radians){var _this=_super.call(this)||this;_this._radians=radians||0;return _this}Object.defineProperty(Angle.prototype,"radians",{get:function(){return this._radians},set:function(value){if(this._radians!==value){this._radians=value;this.notifyObservers()}},enumerable:true,configurable:true});Object.defineProperty(Angle.prototype,"degrees",{get:function(){return this.radians*180/Math.PI},set:function(value){this.radians=value*Math.PI/180},enumerable:true,configurable:true});Angle.prototype.equals=function(a){return this.radians===a.radians};return Angle}(observable_1.Observable);exports.Angle=Angle},{"@daign/observable":15}],6:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var vector2_1=require("./vector2");var Box2=function(_super){__extends(Box2,_super);function Box2(min,max){var _this=_super.call(this)||this;_this._min=min||new vector2_1.Vector2(+Infinity,+Infinity);_this._max=max||new vector2_1.Vector2(-Infinity,-Infinity);var callback=function(){_this.notifyObservers()};_this._min.subscribeToChanges(callback);_this._max.subscribeToChanges(callback);return _this}Object.defineProperty(Box2.prototype,"min",{get:function(){return this._min},enumerable:true,configurable:true});Object.defineProperty(Box2.prototype,"max",{get:function(){return this._max},enumerable:true,configurable:true});Object.defineProperty(Box2.prototype,"isEmpty",{get:function(){return this.max.x<this.min.x||this.max.y<this.min.y},enumerable:true,configurable:true});Object.defineProperty(Box2.prototype,"isArea",{get:function(){return this.max.x>this.min.x&&this.max.y>this.min.y},enumerable:true,configurable:true});Object.defineProperty(Box2.prototype,"size",{get:function(){if(this.isEmpty){return new vector2_1.Vector2(0,0)}return this.max.clone().sub(this.min)},enumerable:true,configurable:true});Box2.prototype.copy=function(b){this.min.copy(b.min);this.max.copy(b.max);return this};Box2.prototype.clone=function(){return new Box2(this.min.clone(),this.max.clone())};Box2.prototype.equals=function(b){return this.min.equals(b.min)&&this.max.equals(b.max)};Box2.prototype.makeEmpty=function(){this.min.x=this.min.y=+Infinity;this.max.x=this.max.y=-Infinity;return this};Box2.prototype.expandByScalar=function(s){this.min.addScalar(-s);this.max.addScalar(s);return this};Box2.prototype.expandByPoint=function(p){this.min.min(p);this.max.max(p);return this};Box2.prototype.expandByBox=function(b){this.min.min(b.min);this.max.max(b.max);return this};Box2.prototype.containsPoint=function(p){return!(p.x<this.min.x||p.x>this.max.x||p.y<this.min.y||p.y>this.max.y)};Box2.prototype.containsBox=function(b){return this.min.x<=b.min.x&&b.max.x<=this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y};return Box2}(observable_1.Observable);exports.Box2=Box2},{"./vector2":13,"@daign/observable":15}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var angle_1=require("./angle");exports.Angle=angle_1.Angle;var box2_1=require("./box2");exports.Box2=box2_1.Box2;var line2_1=require("./line2");exports.Line2=line2_1.Line2;var mathHelper_1=require("./mathHelper");exports.MathHelper=mathHelper_1.MathHelper;var matrix3_1=require("./matrix3");exports.Matrix3=matrix3_1.Matrix3;var triangle2_1=require("./triangle2");exports.Triangle2=triangle2_1.Triangle2;var value_1=require("./value");exports.Value=value_1.Value;var vector2_1=require("./vector2");exports.Vector2=vector2_1.Vector2;var vector3_1=require("./vector3");exports.Vector3=vector3_1.Vector3},{"./angle":5,"./box2":6,"./line2":8,"./mathHelper":9,"./matrix3":10,"./triangle2":11,"./value":12,"./vector2":13,"./vector3":14}],8:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var vector2_1=require("./vector2");var Line2=function(_super){__extends(Line2,_super);function Line2(start,end){var _this=_super.call(this)||this;_this._start=start||new vector2_1.Vector2;_this._end=end||new vector2_1.Vector2;var callback=function(){_this.notifyObservers()};_this._start.subscribeToChanges(callback);_this._end.subscribeToChanges(callback);return _this}Object.defineProperty(Line2.prototype,"start",{get:function(){return this._start},enumerable:true,configurable:true});Object.defineProperty(Line2.prototype,"end",{get:function(){return this._end},enumerable:true,configurable:true});Object.defineProperty(Line2.prototype,"direction",{get:function(){return this.end.clone().sub(this.start)},enumerable:true,configurable:true});Line2.prototype.copy=function(l){this.start.copy(l.start);this.end.copy(l.end);return this};Line2.prototype.clone=function(){return new Line2(this.start.clone(),this.end.clone())};Line2.prototype.equals=function(l){return this.start.equals(l.start)&&this.end.equals(l.end)};Line2.prototype.getCenter=function(){return this.start.clone().add(this.end).multiplyScalar(.5)};Line2.prototype.interpolate=function(t){return this.direction.multiplyScalar(t).add(this.start)};Line2.prototype.isParallel=function(l){var direction1=this.direction;var direction2=l.direction;return direction1.x*direction2.y===direction2.x*direction1.y};Line2.prototype.isPerpendicular=function(l){var direction1=this.direction;var direction2=l.direction;return direction1.dot(direction2)===0};Line2.prototype.getIntersection=function(l){var ax=this.start.x;var ay=this.start.y;var bx=this.end.x;var by=this.end.y;var cx=l.start.x;var cy=l.start.y;var dx=l.end.x;var dy=l.end.y;var n=(bx-ax)*(dy-cy)-(by-ay)*(dx-cx);if(n!==0){var s=((ax-cx)*(dy-cy)-(ay-cy)*(dx-cx))/-n;var x=ax+s*(bx-ax);var y=ay+s*(by-ay);return new vector2_1.Vector2(x,y)}return null};Line2.prototype.getSegmentIntersection=function(l){var ax=this.start.x;var ay=this.start.y;var bx=this.end.x;var by=this.end.y;var cx=l.start.x;var cy=l.start.y;var dx=l.end.x;var dy=l.end.y;var n=(bx-ax)*(dy-cy)-(by-ay)*(dx-cx);if(n!==0){var s=((ax-cx)*(dy-cy)-(ay-cy)*(dx-cx))/-n;var t=((cx-ax)*(by-ay)-(cy-ay)*(bx-ax))/n;if(0<=s&&s<=1&&0<=t&&t<=1){var x=ax+s*(bx-ax);var y=ay+s*(by-ay);return new vector2_1.Vector2(x,y)}}return null};Line2.prototype.getSideOfPoint=function(p){var d=this.direction.cross(p.clone().sub(this.start));var sign=function(x){return Number(x>0)-Number(x<0)};return sign(d)};return Line2}(observable_1.Observable);exports.Line2=Line2},{"./vector2":13,"@daign/observable":15}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var MathHelper=function(){function MathHelper(){}MathHelper.clamp=function(value,min,max){return Math.max(min,Math.min(max,value))};MathHelper.lerp=function(x,y,t){return(1-t)*x+t*y};return MathHelper}();exports.MathHelper=MathHelper},{}],10:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var Matrix3=function(_super){__extends(Matrix3,_super);function Matrix3(a11,a12,a13,a21,a22,a23,a31,a32,a33){var _this=_super.call(this)||this;_this._elements=[];var e=_this._elements;e[0]=a11||0;e[1]=a12||0;e[2]=a13||0;e[3]=a21||0;e[4]=a22||0;e[5]=a23||0;e[6]=a31||0;e[7]=a32||0;e[8]=a33||0;return _this}Object.defineProperty(Matrix3.prototype,"elements",{get:function(){return this._elements},enumerable:true,configurable:true});Matrix3.prototype.set=function(a11,a12,a13,a21,a22,a23,a31,a32,a33){var e=this._elements;if(e[0]!==a11||e[1]!==a12||e[2]!==a13||e[3]!==a21||e[4]!==a22||e[5]!==a23||e[6]!==a31||e[7]!==a32||e[8]!==a33){e[0]=a11;e[1]=a12;e[2]=a13;e[3]=a21;e[4]=a22;e[5]=a23;e[6]=a31;e[7]=a32;e[8]=a33;this.notifyObservers()}return this};Matrix3.prototype.copy=function(m){var e=m.elements;this.set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]);return this};Matrix3.prototype.clone=function(){var e=this.elements;return new Matrix3(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};Matrix3.prototype.equals=function(m){var e1=this.elements;var e2=m.elements;return e1[0]===e2[0]&&e1[1]===e2[1]&&e1[2]===e2[2]&&e1[3]===e2[3]&&e1[4]===e2[4]&&e1[5]===e2[5]&&e1[6]===e2[6]&&e1[7]===e2[7]&&e1[8]===e2[8]};Matrix3.prototype.matrixMultiplication=function(m1,m2){var a=m1.elements;var b=m2.elements;this.set(a[0]*b[0]+a[1]*b[3]+a[2]*b[6],a[0]*b[1]+a[1]*b[4]+a[2]*b[7],a[0]*b[2]+a[1]*b[5]+a[2]*b[8],a[3]*b[0]+a[4]*b[3]+a[5]*b[6],a[3]*b[1]+a[4]*b[4]+a[5]*b[7],a[3]*b[2]+a[4]*b[5]+a[5]*b[8],a[6]*b[0]+a[7]*b[3]+a[8]*b[6],a[6]*b[1]+a[7]*b[4]+a[8]*b[7],a[6]*b[2]+a[7]*b[5]+a[8]*b[8]);return this};Matrix3.prototype.multiply=function(m){this.matrixMultiplication(this,m);return this};Matrix3.prototype.transform=function(m){this.matrixMultiplication(m,this);return this};Matrix3.prototype.setIdentity=function(){this.set(1,0,0,0,1,0,0,0,1);return this};Matrix3.prototype.setTranslation=function(t){this.set(1,0,t.x,0,1,t.y,0,0,1);return this};Matrix3.prototype.setScaling=function(s){this.set(s.x,0,0,0,s.y,0,0,0,1);return this};Matrix3.prototype.setRotation=function(a,p){if(p===undefined){var sin=Math.sin(a.radians);var cos=Math.cos(a.radians);this.set(cos,-sin,0,sin,cos,0,0,0,1)}else{this.setTranslation(p.clone().multiplyScalar(-1));this.applyRotation(a);this.applyTranslation(p)}return this};Matrix3.prototype.applyTranslation=function(t){this.transform((new Matrix3).setTranslation(t));return this};Matrix3.prototype.applyScaling=function(s){this.transform((new Matrix3).setScaling(s));return this};Matrix3.prototype.applyRotation=function(a,p){this.transform((new Matrix3).setRotation(a,p));return this};Matrix3.prototype.determinant=function(){var el=this.elements;var a=el[0];var b=el[1];var c=el[2];var d=el[3];var e=el[4];var f=el[5];var g=el[6];var h=el[7];var i=el[8];return a*e*i-a*f*h-b*d*i+b*f*g+c*d*h-c*e*g};Matrix3.prototype.setToInverse=function(m){var det=m.determinant();if(det===0){throw new Error("Can not invert matrix because determinant is 0.")}var detInv=1/det;var me=m.elements;var a=me[0];var b=me[1];var c=me[2];var d=me[3];var e=me[4];var f=me[5];var g=me[6];var h=me[7];var i=me[8];this.set((i*e-f*h)*detInv,(c*h-i*b)*detInv,(f*b-c*e)*detInv,(f*g-i*d)*detInv,(i*a-c*g)*detInv,(c*d-f*a)*detInv,(h*d-e*g)*detInv,(b*g-h*a)*detInv,(e*a-b*d)*detInv);return this};return Matrix3}(observable_1.Observable);exports.Matrix3=Matrix3},{"@daign/observable":15}],11:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var line2_1=require("./line2");var vector2_1=require("./vector2");var vector3_1=require("./vector3");var Triangle2=function(_super){__extends(Triangle2,_super);function Triangle2(a,b,c){var _this=_super.call(this)||this;_this._a=a||new vector2_1.Vector2;_this._b=b||new vector2_1.Vector2;_this._c=c||new vector2_1.Vector2;var callback=function(){_this.notifyObservers()};_this._a.subscribeToChanges(callback);_this._b.subscribeToChanges(callback);_this._c.subscribeToChanges(callback);return _this}Object.defineProperty(Triangle2.prototype,"a",{get:function(){return this._a},enumerable:true,configurable:true});Object.defineProperty(Triangle2.prototype,"b",{get:function(){return this._b},enumerable:true,configurable:true});Object.defineProperty(Triangle2.prototype,"c",{get:function(){return this._c},enumerable:true,configurable:true});Triangle2.prototype.copy=function(t){this.a.copy(t.a);this.b.copy(t.b);this.c.copy(t.c);return this};Triangle2.prototype.clone=function(){return new Triangle2(this.a.clone(),this.b.clone(),this.c.clone())};Triangle2.prototype.equals=function(t){return this.a.equals(t.a)&&this.b.equals(t.b)&&this.c.equals(t.c)};Triangle2.prototype.getBarycoord=function(p){var v0=this.b.clone().sub(this.a);var v1=this.c.clone().sub(this.a);var v2=p.clone().sub(this.a);var dot00=v0.dot(v0);var dot01=v0.dot(v1);var dot02=v0.dot(v2);var dot11=v1.dot(v1);var dot12=v1.dot(v2);var denom=dot00*dot11-dot01*dot01;if(denom===0){return null}var invDenom=1/denom;var u=(dot11*dot02-dot01*dot12)*invDenom;var v=(dot00*dot12-dot01*dot02)*invDenom;return new vector3_1.Vector3(1-u-v,v,u)};Triangle2.prototype.containsPoint=function(p){var barycoord=this.getBarycoord(p);if(barycoord!==null){return barycoord.x>=0&&barycoord.y>=0&&barycoord.x+barycoord.y<=1}return null};Triangle2.prototype.getCircumcenter=function(){var side1=this.b.clone().sub(this.a);var side2=this.c.clone().sub(this.a);var midpoint1=side1.clone().multiplyScalar(.5).add(this.a);var midpoint2=side2.clone().multiplyScalar(.5).add(this.a);var line1=new line2_1.Line2(midpoint1,side1.perpendicular().add(midpoint1));var line2=new line2_1.Line2(midpoint2,side2.perpendicular().add(midpoint2));return line1.getIntersection(line2)};return Triangle2}(observable_1.Observable);exports.Triangle2=Triangle2},{"./line2":8,"./vector2":13,"./vector3":14,"@daign/observable":15}],12:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var Value=function(_super){__extends(Value,_super);function Value(x){var _this=_super.call(this)||this;_this._x=x||0;_this.snapshot=undefined;return _this}Object.defineProperty(Value.prototype,"x",{get:function(){return this._x},set:function(value){if(this._x!==value){this._x=value;this.notifyObservers()}},enumerable:true,configurable:true});Value.prototype.setSilent=function(x){this._x=x;return this};Value.prototype.clone=function(){return new Value(this.x)};Value.prototype.clamp=function(min,max){this.x=Math.max(min,Math.min(max,this.x));return this};Value.prototype.snap=function(){this.snapshot=this.clone();return this};Value.prototype.drag=function(v){if(this.snapshot!==undefined){this.x=this.snapshot.x+v}return this};return Value}(observable_1.Observable);exports.Value=Value},{"@daign/observable":15}],13:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var angle_1=require("./angle");var Vector2=function(_super){__extends(Vector2,_super);function Vector2(x,y){var _this=_super.call(this)||this;_this._x=x||0;_this._y=y||0;_this.snapshot=undefined;return _this}Object.defineProperty(Vector2.prototype,"x",{get:function(){return this._x},set:function(value){if(this._x!==value){this._x=value;this.notifyObservers()}},enumerable:true,configurable:true});Object.defineProperty(Vector2.prototype,"y",{get:function(){return this._y},set:function(value){if(this._y!==value){this._y=value;this.notifyObservers()}},enumerable:true,configurable:true});Vector2.prototype.set=function(x,y){if(this._x!==x||this._y!==y){this._x=x;this._y=y;this.notifyObservers()}return this};Vector2.prototype.setSilent=function(x,y){this._x=x;this._y=y;return this};Vector2.prototype.setFromEvent=function(event){if(event.clientX!==undefined&&event.clientY!==undefined){this.set(event.clientX,event.clientY);return this}else if(event.touches&&event.touches[0]&&event.touches[0].clientX&&event.touches[0].clientY){this.set(event.touches[0].clientX,event.touches[0].clientY);return this}else{return this}};Vector2.prototype.setFromEventRelative=function(event){if(event.offsetX!==undefined&&event.offsetY!==undefined){this.set(event.offsetX,event.offsetY);return this}else if(event.targetTouches&&event.targetTouches[0]&&event.targetTouches[0].pageX&&event.targetTouches[0].pageY){var rect=event.target.getBoundingClientRect();var x=event.targetTouches[0].pageX-rect.left;var y=event.targetTouches[0].pageY-rect.top;this.set(x,y);return this}else{return this}};Vector2.prototype.copy=function(v){this.set(v.x,v.y);return this};Vector2.prototype.clone=function(){return new Vector2(this.x,this.y)};Vector2.prototype.equals=function(v){return this.x===v.x&&this.y===v.y};Vector2.prototype.add=function(v){this.set(this.x+v.x,this.y+v.y);return this};Vector2.prototype.sub=function(v){this.set(this.x-v.x,this.y-v.y);return this};Vector2.prototype.multiply=function(v){this.set(this.x*v.x,this.y*v.y);return this};Vector2.prototype.divide=function(v){this.set(this.x/v.x,this.y/v.y);return this};Vector2.prototype.addScalar=function(s){this.set(this.x+s,this.y+s);return this};Vector2.prototype.multiplyScalar=function(s){this.set(this.x*s,this.y*s);return this};Vector2.prototype.transform=function(m){var a=m.elements;var x=a[0]*this.x+a[1]*this.y+a[2];var y=a[3]*this.x+a[4]*this.y+a[5];var w=a[6]*this.x+a[7]*this.y+a[8];this.set(x/w,y/w);return this};Vector2.prototype.min=function(v){this.set(Math.min(this.x,v.x),Math.min(this.y,v.y));return this};Vector2.prototype.max=function(v){this.set(Math.max(this.x,v.x),Math.max(this.y,v.y));return this};Vector2.prototype.abs=function(){this.set(Math.abs(this.x),Math.abs(this.y));return this};Vector2.prototype.round=function(){this.set(Math.round(this.x),Math.round(this.y));return this};Vector2.prototype.floor=function(){this.set(Math.floor(this.x),Math.floor(this.y));return this};Vector2.prototype.ceil=function(){this.set(Math.ceil(this.x),Math.ceil(this.y));return this};Vector2.prototype.clampInBox=function(b){this.min(b.max);this.max(b.min);return this};Vector2.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};Vector2.prototype.normalize=function(){var length=this.length();if(length!==0){this.multiplyScalar(1/length)}return this};Vector2.prototype.setLength=function(l){var oldLength=this.length();if(oldLength!==0){this.multiplyScalar(l/oldLength)}return this};Vector2.prototype.distanceTo=function(v){return Math.sqrt(Math.pow(this.x-v.x,2)+Math.pow(this.y-v.y,2))};Vector2.prototype.angle=function(){var angle=Math.atan2(this.y,this.x);if(angle<0){angle+=2*Math.PI}return new angle_1.Angle(angle)};Vector2.prototype.dot=function(v){return this.x*v.x+this.y*v.y};Vector2.prototype.cross=function(v){return this.x*v.y-this.y*v.x};Vector2.prototype.snap=function(){this.snapshot=this.clone();return this};Vector2.prototype.drag=function(v){if(this.snapshot!==undefined){this.copy(this.snapshot.clone().add(v))}return this};Vector2.prototype.projectOnLine=function(l){var support=this.clone().sub(l.start);var direction=l.end.clone().sub(l.start);var directionN=direction.clone().normalize();var d=support.dot(directionN);return directionN.clone().multiplyScalar(d).add(l.start)};Vector2.prototype.projectOnLineSegment=function(l){var support=this.clone().sub(l.start);var direction=l.end.clone().sub(l.start);var directionN=direction.clone().normalize();var d=support.dot(directionN);if(d>=0&&d<=direction.length()){return directionN.clone().multiplyScalar(d).add(l.start)}else{return null}};Vector2.prototype.perpendicular=function(){return new Vector2(this.y,-this.x)};return Vector2}(observable_1.Observable);exports.Vector2=Vector2},{"./angle":5,"@daign/observable":15}],14:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var Vector3=function(_super){__extends(Vector3,_super);function Vector3(x,y,z){var _this=_super.call(this)||this;_this._x=x||0;_this._y=y||0;_this._z=z||0;return _this}Object.defineProperty(Vector3.prototype,"x",{get:function(){return this._x},set:function(value){if(this._x!==value){this._x=value;this.notifyObservers()}},enumerable:true,configurable:true});Object.defineProperty(Vector3.prototype,"y",{get:function(){return this._y},set:function(value){if(this._y!==value){this._y=value;this.notifyObservers()}},enumerable:true,configurable:true});Object.defineProperty(Vector3.prototype,"z",{get:function(){return this._z},set:function(value){if(this._z!==value){this._z=value;this.notifyObservers()}},enumerable:true,configurable:true});Vector3.prototype.set=function(x,y,z){if(this._x!==x||this._y!==y||this._z!==z){this._x=x;this._y=y;this._z=z;this.notifyObservers()}return this};Vector3.prototype.setSilent=function(x,y,z){this._x=x;this._y=y;this._z=z;return this};Vector3.prototype.copy=function(v){this.set(v.x,v.y,v.z);return this};Vector3.prototype.clone=function(){return new Vector3(this.x,this.y,this.z)};Vector3.prototype.equals=function(v){return this.x===v.x&&this.y===v.y&&this.z===v.z};Vector3.prototype.add=function(v){this.set(this.x+v.x,this.y+v.y,this.z+v.z);return this};Vector3.prototype.sub=function(v){this.set(this.x-v.x,this.y-v.y,this.z-v.z);return this};Vector3.prototype.multiply=function(v){this.set(this.x*v.x,this.y*v.y,this.z*v.z);return this};Vector3.prototype.divide=function(v){this.set(this.x/v.x,this.y/v.y,this.z/v.z);return this};Vector3.prototype.addScalar=function(s){this.set(this.x+s,this.y+s,this.z+s);return this};Vector3.prototype.multiplyScalar=function(s){this.set(this.x*s,this.y*s,this.z*s);return this};Vector3.prototype.min=function(v){this.set(Math.min(this.x,v.x),Math.min(this.y,v.y),Math.min(this.z,v.z));return this};Vector3.prototype.max=function(v){this.set(Math.max(this.x,v.x),Math.max(this.y,v.y),Math.max(this.z,v.z));return this};return Vector3}(observable_1.Observable);exports.Vector3=Vector3},{"@daign/observable":15}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("./observable");exports.Observable=observable_1.Observable},{"./observable":16}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Observable=function(){function Observable(){this.listeners=[]}Observable.prototype.subscribeToChanges=function(callback){var _this=this;this.listeners.push(callback);return function(){var i=_this.listeners.indexOf(callback);if(i>-1){_this.listeners.splice(i,1)}}};Observable.prototype.notifyObservers=function(){this.listeners.forEach(function(callback){callback()})};Observable.prototype.clearObservers=function(){this.listeners=[]};return Observable}();exports.Observable=Observable},{}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var schedule_1=require("./schedule");exports.Schedule=schedule_1.Schedule},{"./schedule":18}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Schedule=function(){function Schedule(){}Schedule.postpone=function(callback,wait,context){if(context===void 0){context=null}return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}setTimeout(function(){callback.apply(context,args)},wait)}};Schedule.blockingThrottle=function(callback,wait,context){if(context===void 0){context=null}var blocked=false;return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}if(!blocked){blocked=true;callback.apply(context,args);setTimeout(function(){blocked=false},wait)}}};Schedule.deferringThrottle=function(callback,wait,context){if(context===void 0){context=null}var blocked=false;var deferredCalls=false;var lastArgs;var execute=function(args){callback.apply(context,args);setTimeout(function(){if(deferredCalls){deferredCalls=false;execute(lastArgs)}else{blocked=false}},wait)};return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}if(blocked){lastArgs=args;deferredCalls=true}else{blocked=true;deferredCalls=false;execute(args)}}};return Schedule}();exports.Schedule=Schedule},{}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var math_1=require("@daign/math");var control_objects_1=require("./control-objects");var float_bar_1=require("./float-bar");var selection_manager_1=require("./selection-manager");var svg_elements_1=require("./svg-elements");var tool_manager_1=require("./tool-manager");var Application=function(){function Application(container){var _this=this;this.svgContext=new svg_elements_1.Context(container);this.backgroundLayer=new svg_elements_1.Group;this.svgContext.addElement(this.backgroundLayer);this.documentLayer=new svg_elements_1.Group;this.svgContext.addElement(this.documentLayer);this.selectionManager=new selection_manager_1.SelectionManager;this.svgContext.addElement(this.selectionManager);this.floatBar=new float_bar_1.FloatBar;this.svgContext.addElement(this.floatBar);this.controlFactory=new control_objects_1.ControlFactory(this.selectionManager,this.floatBar);this.toolManager=new tool_manager_1.ToolManager(this.selectionManager,this.controlFactory,this.floatBar);var globalOnMouseDown=function(event){var position=new math_1.Vector2;position.setFromEventRelative(event);_this.toolManager.globalAction(position);event.stopPropagation();event.preventDefault()};this.svgContext.setOnMouseDownAction(globalOnMouseDown)}return Application}();exports.Application=Application},{"./control-objects":35,"./float-bar":40,"./selection-manager":42,"./svg-elements":47,"./tool-manager":50,"@daign/math":7}],20:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var BasicCircle=function(_super){__extends(BasicCircle,_super);function BasicCircle(c,r){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"circle");_this.baseStyle="basicCircle";_this.repaint(c,r);return _this}BasicCircle.prototype.repaint=function(c,r){this.node.setAttribute("cx",String(c.x));this.node.setAttribute("cy",String(c.y));this.node.setAttribute("r",String(r))};return BasicCircle}(svg_node_object_1.SvgNodeObject);exports.BasicCircle=BasicCircle},{"../svg-constants":43,"../svg-node-object":49}],21:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var BasicLine=function(_super){__extends(BasicLine,_super);function BasicLine(p1,p2){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"line");_this.baseStyle="basicLine";_this.repaint(p1,p2);return _this}BasicLine.prototype.repaint=function(p1,p2){this.node.setAttribute("x1",String(p1.x));this.node.setAttribute("y1",String(p1.y));this.node.setAttribute("x2",String(p2.x));this.node.setAttribute("y2",String(p2.y))};return BasicLine}(svg_node_object_1.SvgNodeObject);exports.BasicLine=BasicLine},{"../svg-constants":43,"../svg-node-object":49}],22:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var BasicPath=function(_super){__extends(BasicPath,_super);function BasicPath(d){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"path");_this.baseStyle="basicPath";_this.repaint(d);return _this}BasicPath.prototype.repaint=function(d){this.node.setAttribute("d",d)};return BasicPath}(svg_node_object_1.SvgNodeObject);exports.BasicPath=BasicPath},{"../svg-constants":43,"../svg-node-object":49}],23:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var BasicPolygon=function(_super){__extends(BasicPolygon,_super);function BasicPolygon(points){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"polygon");_this.baseStyle="basicPolygon";_this.repaint(points);return _this}BasicPolygon.prototype.repaint=function(points){var pointsString=points.map(function(point){return point.x+","+point.y}).join(" ");this.node.setAttribute("points",pointsString)};return BasicPolygon}(svg_node_object_1.SvgNodeObject);exports.BasicPolygon=BasicPolygon},{"../svg-constants":43,"../svg-node-object":49}],24:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var BasicPolyline=function(_super){__extends(BasicPolyline,_super);function BasicPolyline(points){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"polyline");_this.baseStyle="basicPolyline";_this.repaint(points);return _this}BasicPolyline.prototype.repaint=function(points){var pointsString=points.map(function(point){return point.x+","+point.y}).join(" ");this.node.setAttribute("points",pointsString)};return BasicPolyline}(svg_node_object_1.SvgNodeObject);exports.BasicPolyline=BasicPolyline},{"../svg-constants":43,"../svg-node-object":49}],25:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var BasicRectangle=function(_super){__extends(BasicRectangle,_super);function BasicRectangle(x,y,width,height,rx,ry){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"rect");_this.baseStyle="basicRectangle";_this.repaint(x,y,width,height,rx||0,ry||0);return _this}BasicRectangle.prototype.repaint=function(x,y,width,height,rx,ry){this.node.setAttribute("x",String(x));this.node.setAttribute("y",String(y));this.node.setAttribute("width",String(width));this.node.setAttribute("height",String(height));this.node.setAttribute("rx",String(rx||0));this.node.setAttribute("ry",String(ry||0))};return BasicRectangle}(svg_node_object_1.SvgNodeObject);exports.BasicRectangle=BasicRectangle},{"../svg-constants":43,"../svg-node-object":49}],26:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var BasicText=function(_super){__extends(BasicText,_super);function BasicText(x,y,text){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"text");_this.baseStyle="basicText";_this.repaint(x,y,text);return _this}BasicText.prototype.repaint=function(x,y,text){this.node.setAttribute("x",String(x));this.node.setAttribute("y",String(y));this.node.textContent=text};BasicText.prototype.setText=function(t){this.node.textContent=t};return BasicText}(svg_node_object_1.SvgNodeObject);exports.BasicText=BasicText},{"../svg-constants":43,"../svg-node-object":49}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var basic_line_1=require("./basic-line");exports.BasicLine=basic_line_1.BasicLine;var basic_polygon_1=require("./basic-polygon");exports.BasicPolygon=basic_polygon_1.BasicPolygon;var basic_polyline_1=require("./basic-polyline");exports.BasicPolyline=basic_polyline_1.BasicPolyline;var basic_rectangle_1=require("./basic-rectangle");exports.BasicRectangle=basic_rectangle_1.BasicRectangle;var basic_circle_1=require("./basic-circle");exports.BasicCircle=basic_circle_1.BasicCircle;var basic_text_1=require("./basic-text");exports.BasicText=basic_text_1.BasicText;var basic_path_1=require("./basic-path");exports.BasicPath=basic_path_1.BasicPath},{"./basic-circle":20,"./basic-line":21,"./basic-path":22,"./basic-polygon":23,"./basic-polyline":24,"./basic-rectangle":25,"./basic-text":26}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ControlModifier=function(){function ControlModifier(){this.nextModifier=null}ControlModifier.prototype.alignLast=function(points){if(points.length>0){this.align(points,points.length-1)}};ControlModifier.prototype.align=function(points,i){if(this.nextModifier!==null){this.nextModifier.align(points,i)}};ControlModifier.prototype.chain=function(modifier){this.nextModifier=modifier};return ControlModifier}();exports.ControlModifier=ControlModifier},{}],29:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var control_modifier_1=require("./control-modifier");var GridModifier=function(_super){__extends(GridModifier,_super);function GridModifier(gridSize){var _this=_super.call(this)||this;_this.enabled=true;_this.gridSize=gridSize;return _this}GridModifier.prototype.align=function(points,i){if(this.enabled&&i<points.length){var point=points[i];point.setSilent(Math.round(point.x/this.gridSize)*this.gridSize,Math.round(point.y/this.gridSize)*this.gridSize)}_super.prototype.align.call(this,points,i)};GridModifier.prototype.enable=function(value){this.enabled=value};return GridModifier}(control_modifier_1.ControlModifier);exports.GridModifier=GridModifier},{"./control-modifier":28}],30:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var control_modifier_1=require("./control-modifier");var OrthogonalModifier=function(_super){__extends(OrthogonalModifier,_super);function OrthogonalModifier(){var _this=_super.call(this)||this;_this.enabled=true;return _this}OrthogonalModifier.prototype.align=function(points,i){if(this.enabled&&i<points.length&&i>0&&points.length>1){var last=points[i];var previous=points[i-1];var diffHorizontal=Math.abs(last.x-previous.x);var diffVertical=Math.abs(last.y-previous.y);if(diffHorizontal>diffVertical){last.setSilent(last.x,previous.y)}else{last.setSilent(previous.x,last.y)}}_super.prototype.align.call(this,points,i)};OrthogonalModifier.prototype.enable=function(value){this.enabled=value};return OrthogonalModifier}(control_modifier_1.ControlModifier);exports.OrthogonalModifier=OrthogonalModifier},{"./control-modifier":28}],31:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var math_1=require("@daign/math");var basic_shapes_1=require("../basic-shapes");var svg_constants_1=require("../svg-constants");var control_object_1=require("./control-object");var CircleControl=function(_super){__extends(CircleControl,_super);function CircleControl(selectionManager){var _this=_super.call(this,selectionManager)||this;_this.baseStyle="circleControl";_this.circleShapesNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.shapesNode.appendChild(_this.circleShapesNode);return _this}Object.defineProperty(CircleControl.prototype,"boundingBox",{get:function(){var box=new math_1.Box2;var points=this.points;if(points.length>1){var radius=points[0].distanceTo(points[1]);box.expandByPoint(points[0].clone().addScalar(radius));box.expandByPoint(points[0].clone().addScalar(-radius))}else{box.expandByPoint(points[0])}return box},enumerable:true,configurable:true});Object.defineProperty(CircleControl.prototype,"drawingFinished",{get:function(){return this.points.length>=2},enumerable:true,configurable:true});CircleControl.prototype.addPoint=function(position){if(this.points.length<2){_super.prototype.addPoint.call(this,position)}};CircleControl.prototype.updateGeometry=function(){_super.prototype.updateGeometry.call(this);while(this.circleShapesNode.firstChild){this.circleShapesNode.removeChild(this.circleShapesNode.firstChild)}this.circleShape=undefined;var points=this.points;if(points.length===2){var center=points[0];var radius=points[1].distanceTo(points[0]);this.circleShape=new basic_shapes_1.BasicCircle(center,radius);this.circleShapesNode.appendChild(this.circleShape.node)}};CircleControl.prototype.repaint=function(){_super.prototype.repaint.call(this);if(this.circleShape){var points=this.points;var center=points[0];var radius=points[1].distanceTo(points[0]);this.circleShape.repaint(center,radius)}};return CircleControl}(control_object_1.ControlObject);exports.CircleControl=CircleControl},{"../basic-shapes":27,"../svg-constants":43,"./control-object":33,"@daign/math":7}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var circle_control_1=require("./circle-control");var polygon_control_1=require("./polygon-control");var polyline_control_1=require("./polyline-control");var rectangle_control_1=require("./rectangle-control");var three_point_circle_control_1=require("./three-point-circle-control");var ControlFactory=function(){function ControlFactory(selectionManager,floatBar){this.afterCreateHook=null;this.lookUpTable={circleControl:circle_control_1.CircleControl,polygonControl:polygon_control_1.PolygonControl,polylineControl:polyline_control_1.PolylineControl,rectangleControl:rectangle_control_1.RectangleControl,threePointCircleControl:three_point_circle_control_1.ThreePointCircleControl};this.selectionManager=selectionManager;this.floatBar=floatBar}ControlFactory.prototype.createControl=function(controlName){var control=new this.lookUpTable[controlName](this.selectionManager);control.floatBar=this.floatBar;if(this.afterCreateHook){this.afterCreateHook(control,controlName)}return control};ControlFactory.prototype.parseFromXML=function(xmlNode){var classListToArray=function(classList){var p=[];for(var i=0;i<classList.length;i+=1){p.push(classList[i])}return p};var _a=classListToArray(xmlNode.classList),baseStyle=_a[0],customStyle=_a.slice(1);var control=null;if(this.lookUpTable.hasOwnProperty(baseStyle)){control=this.createControl(baseStyle);control.parseFromXML(xmlNode);control.style=customStyle.filter(function(s){return s!=="selected"}).join(" ")}return control};ControlFactory.prototype.addControl=function(styleName,classRef){this.lookUpTable[styleName]=classRef};return ControlFactory}();exports.ControlFactory=ControlFactory},{"./circle-control":31,"./polygon-control":36,"./polyline-control":37,"./rectangle-control":38,"./three-point-circle-control":39}],33:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var handle_1=require("@daign/handle");var math_1=require("@daign/math");var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var control_point_1=require("./control-point");var ControlObject=function(_super){__extends(ControlObject,_super);function ControlObject(selectionManager){var _this=_super.call(this)||this;_this.floatBar=null;_this.controls=[];_this.restrictor=null;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.controlsNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.shapesNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.overlayNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.node.appendChild(_this.shapesNode);_this.node.appendChild(_this.controlsNode);_this.node.appendChild(_this.overlayNode);var handle=new handle_1.Handle(_this.shapesNode);handle.beginning=function(){selectionManager.set(_this);return false};return _this}Object.defineProperty(ControlObject.prototype,"points",{get:function(){return this.controls.map(function(control){return control.position})},enumerable:true,configurable:true});Object.defineProperty(ControlObject.prototype,"lines",{get:function(){return[]},enumerable:true,configurable:true});Object.defineProperty(ControlObject.prototype,"boundingBox",{get:function(){var box=new math_1.Box2;this.points.forEach(function(point){box.expandByPoint(point)});return box},enumerable:true,configurable:true});Object.defineProperty(ControlObject.prototype,"drawingFinished",{get:function(){return false},enumerable:true,configurable:true});ControlObject.prototype.addPoint=function(position){var _this=this;var next=this.controls.length;var point=new control_point_1.ControlPoint(function(){if(_this.restrictor){_this.restrictor.align(_this.points,next)}_this.repaint()},position,this.floatBar);this.controls.push(point);if(this.restrictor){this.restrictor.alignLast(this.points)}this.controlsNode.appendChild(point.node);this.updateGeometry();this.repaint()};ControlObject.prototype.updateGeometry=function(){this.notifyObservers()};ControlObject.prototype.repaint=function(){this.notifyObservers();for(var i=0;i<this.controls.length;i+=1){this.controls[i].repaint()}};ControlObject.prototype.addRestrictor=function(restrictor){this.restrictor=restrictor};ControlObject.prototype.parseFromXML=function(node){var _this=this;var controlPoints=node.childNodes[1].childNodes;controlPoints.forEach(function(cp){_this.addPoint(new math_1.Vector2(parseFloat(cp.getAttribute("cx")),parseFloat(cp.getAttribute("cy"))))})};return ControlObject}(svg_node_object_1.SvgNodeObject);exports.ControlObject=ControlObject},{"../svg-constants":43,"../svg-node-object":49,"./control-point":34,"@daign/handle":4,"@daign/math":7}],34:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var handle_1=require("@daign/handle");var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var ControlPoint=function(_super){__extends(ControlPoint,_super);function ControlPoint(repaintCallback,position,floatBar){var _this=_super.call(this)||this;_this.repaintCallback=repaintCallback;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"circle");_this.node.setAttribute("r",12);_this.baseStyle="controlPoint";_this.position=position.clone();var snapshot;var onMove=function(){_this.repaintCallback()};_this.position.subscribeToChanges(onMove);_this.repaint();var handle=new handle_1.Handle(_this.node);handle.beginning=function(){snapshot=_this.position.clone();if(floatBar){floatBar.setText(_this.position.x+", "+_this.position.y);floatBar.display(true)}return true};handle.continuing=function(){_this.position.copy(snapshot.clone().add(handle.delta));if(floatBar){floatBar.setText(_this.position.x+", "+_this.position.y)}};handle.ending=function(){if(floatBar){floatBar.display(false)}};return _this}ControlPoint.prototype.repaint=function(){var x=this.position.x;var y=this.position.y;this.node.setAttribute("cx",String(x));this.node.setAttribute("cy",String(y))};return ControlPoint}(svg_node_object_1.SvgNodeObject);exports.ControlPoint=ControlPoint},{"../svg-constants":43,"../svg-node-object":49,"@daign/handle":4}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var control_point_1=require("./control-point");exports.ControlPoint=control_point_1.ControlPoint;var control_object_1=require("./control-object");exports.ControlObject=control_object_1.ControlObject;var polyline_control_1=require("./polyline-control");exports.PolylineControl=polyline_control_1.PolylineControl;var polygon_control_1=require("./polygon-control");exports.PolygonControl=polygon_control_1.PolygonControl;var rectangle_control_1=require("./rectangle-control");exports.RectangleControl=rectangle_control_1.RectangleControl;var circle_control_1=require("./circle-control");exports.CircleControl=circle_control_1.CircleControl;var three_point_circle_control_1=require("./three-point-circle-control");exports.ThreePointCircleControl=three_point_circle_control_1.ThreePointCircleControl;var control_factory_1=require("./control-factory");exports.ControlFactory=control_factory_1.ControlFactory},{"./circle-control":31,"./control-factory":32,"./control-object":33,"./control-point":34,"./polygon-control":36,"./polyline-control":37,"./rectangle-control":38,"./three-point-circle-control":39}],36:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var math_1=require("@daign/math");var basic_polygon_1=require("../basic-shapes/basic-polygon");var svg_constants_1=require("../svg-constants");var control_object_1=require("./control-object");var PolygonControl=function(_super){__extends(PolygonControl,_super);function PolygonControl(selectionManager){var _this=_super.call(this,selectionManager)||this;_this.baseStyle="polygonControl";_this.polygonShapesNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.shapesNode.appendChild(_this.polygonShapesNode);return _this}Object.defineProperty(PolygonControl.prototype,"lines",{get:function(){return this.points.map(function(point,index,array){if(index<array.length-1){return new math_1.Line2(point,array[index+1])}else{return new math_1.Line2(point,array[0])}})},enumerable:true,configurable:true});PolygonControl.prototype.addPoint=function(position){_super.prototype.addPoint.call(this,position)};PolygonControl.prototype.updateGeometry=function(){_super.prototype.updateGeometry.call(this);while(this.polygonShapesNode.firstChild){this.polygonShapesNode.removeChild(this.polygonShapesNode.firstChild)}this.polygonShape=undefined;this.polygonShape=new basic_polygon_1.BasicPolygon(this.points);this.polygonShapesNode.appendChild(this.polygonShape.node)};PolygonControl.prototype.repaint=function(){_super.prototype.repaint.call(this);if(this.polygonShape){this.polygonShape.repaint(this.points)}};return PolygonControl}(control_object_1.ControlObject);exports.PolygonControl=PolygonControl},{"../basic-shapes/basic-polygon":23,"../svg-constants":43,"./control-object":33,"@daign/math":7}],37:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var math_1=require("@daign/math");var basic_shapes_1=require("../basic-shapes");var svg_constants_1=require("../svg-constants");var control_object_1=require("./control-object");var PolylineControl=function(_super){__extends(PolylineControl,_super);function PolylineControl(selectionManager){var _this=_super.call(this,selectionManager)||this;_this.baseStyle="polylineControl";_this.polylineShapesNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.shapesNode.appendChild(_this.polylineShapesNode);return _this}Object.defineProperty(PolylineControl.prototype,"lines",{get:function(){return this.points.map(function(point,index,array){if(index<array.length-1){return new math_1.Line2(point,array[index+1])}else{return null}}).filter(function(line){return line!==null})},enumerable:true,configurable:true});PolylineControl.prototype.addPoint=function(position){_super.prototype.addPoint.call(this,position)};PolylineControl.prototype.updateGeometry=function(){_super.prototype.updateGeometry.call(this);while(this.polylineShapesNode.firstChild){this.polylineShapesNode.removeChild(this.polylineShapesNode.firstChild)}this.polylineShape=undefined;this.polylineShape=new basic_shapes_1.BasicPolyline(this.points);this.polylineShapesNode.appendChild(this.polylineShape.node)};PolylineControl.prototype.repaint=function(){_super.prototype.repaint.call(this);if(this.polylineShape){this.polylineShape.repaint(this.points)}};return PolylineControl}(control_object_1.ControlObject);exports.PolylineControl=PolylineControl},{"../basic-shapes":27,"../svg-constants":43,"./control-object":33,"@daign/math":7}],38:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var math_1=require("@daign/math");var basic_shapes_1=require("../basic-shapes");var svg_constants_1=require("../svg-constants");var control_object_1=require("./control-object");var RectangleControl=function(_super){__extends(RectangleControl,_super);function RectangleControl(selectionManager){var _this=_super.call(this,selectionManager)||this;_this.baseStyle="rectangleControl";_this.rectangleShapesNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.shapesNode.appendChild(_this.rectangleShapesNode);return _this}Object.defineProperty(RectangleControl.prototype,"lines",{get:function(){var points=this.points;if(points.length===2){var rectPoints=[new math_1.Vector2(points[0].x,points[0].y),new math_1.Vector2(points[1].x,points[0].y),new math_1.Vector2(points[1].x,points[1].y),new math_1.Vector2(points[0].x,points[1].y)];return[new math_1.Line2(rectPoints[0],rectPoints[1]),new math_1.Line2(rectPoints[1],rectPoints[2]),new math_1.Line2(rectPoints[2],rectPoints[3]),new math_1.Line2(rectPoints[3],rectPoints[0])]}else{return[]}},enumerable:true,configurable:true});Object.defineProperty(RectangleControl.prototype,"drawingFinished",{get:function(){return this.points.length>=2},enumerable:true,configurable:true});RectangleControl.prototype.addPoint=function(position){if(this.points.length<2){_super.prototype.addPoint.call(this,position)}};RectangleControl.prototype.updateGeometry=function(){_super.prototype.updateGeometry.call(this);while(this.rectangleShapesNode.firstChild){this.rectangleShapesNode.removeChild(this.rectangleShapesNode.firstChild)}this.rectangleShape=undefined;var points=this.points;if(points.length===2){var x=Math.min(points[0].x,points[1].x);var y=Math.min(points[0].y,points[1].y);var dimensions=points[1].clone().sub(points[0]).abs();this.rectangleShape=new basic_shapes_1.BasicRectangle(x,y,dimensions.x,dimensions.y);this.rectangleShapesNode.appendChild(this.rectangleShape.node)}};RectangleControl.prototype.repaint=function(){_super.prototype.repaint.call(this);if(this.rectangleShape){var points=this.points;var x=Math.min(points[0].x,points[1].x);var y=Math.min(points[0].y,points[1].y);var dimensions=points[1].clone().sub(points[0]).abs();this.rectangleShape.repaint(x,y,dimensions.x,dimensions.y)}};return RectangleControl}(control_object_1.ControlObject);exports.RectangleControl=RectangleControl},{"../basic-shapes":27,"../svg-constants":43,"./control-object":33,"@daign/math":7}],39:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var math_1=require("@daign/math");var basic_shapes_1=require("../basic-shapes");var svg_constants_1=require("../svg-constants");var control_object_1=require("./control-object");var ThreePointCircleControl=function(_super){__extends(ThreePointCircleControl,_super);function ThreePointCircleControl(selectionManager){var _this=_super.call(this,selectionManager)||this;_this.baseStyle="threePointCircleControl";_this.circleShapesNode=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.shapesNode.appendChild(_this.circleShapesNode);return _this}Object.defineProperty(ThreePointCircleControl.prototype,"boundingBox",{get:function(){var box=new math_1.Box2;var points=this.points;if(points.length>2){var triangle=new math_1.Triangle2(points[0],points[1],points[2]);var center=triangle.getCircumcenter();if(center!==null){var radius=center.distanceTo(points[0]);box.expandByPoint(center.clone().addScalar(radius));box.expandByPoint(center.clone().addScalar(-radius))}else{box.expandByPoint(points[0]);box.expandByPoint(points[1]);box.expandByPoint(points[2])}}else if(points.length>1){box.expandByPoint(points[0]);box.expandByPoint(points[1])}else{box.expandByPoint(points[0])}return box},enumerable:true,configurable:true});Object.defineProperty(ThreePointCircleControl.prototype,"drawingFinished",{get:function(){return this.points.length>=3},enumerable:true,configurable:true});ThreePointCircleControl.prototype.addPoint=function(position){if(this.points.length<3){_super.prototype.addPoint.call(this,position)}};ThreePointCircleControl.prototype.updateGeometry=function(){_super.prototype.updateGeometry.call(this);while(this.circleShapesNode.firstChild){this.circleShapesNode.removeChild(this.circleShapesNode.firstChild)}this.circleShape=undefined;if(this.points.length===3){var points=this.points;var triangle=new math_1.Triangle2(points[0],points[1],points[2]);var center=triangle.getCircumcenter();if(center!==null){var radius=center.distanceTo(points[0]);this.circleShape=new basic_shapes_1.BasicCircle(center,radius);this.circleShapesNode.appendChild(this.circleShape.node)}}};ThreePointCircleControl.prototype.repaint=function(){_super.prototype.repaint.call(this);if(this.circleShape){var points=this.points;var triangle=new math_1.Triangle2(points[0],points[1],points[2]);var center=triangle.getCircumcenter();if(center!==null){var radius=center.distanceTo(points[0]);this.circleShape.repaint(center,radius)}}};return ThreePointCircleControl}(control_object_1.ControlObject);exports.ThreePointCircleControl=ThreePointCircleControl},{"../basic-shapes":27,"../svg-constants":43,"./control-object":33,"@daign/math":7}],40:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var basic_shapes_1=require("./basic-shapes");var svg_elements_1=require("./svg-elements");var FloatBar=function(_super){__extends(FloatBar,_super);function FloatBar(){var _this=_super.call(this)||this;_this.style="floatBar hidden";var background=new basic_shapes_1.BasicRectangle(20,740,240,40,20,20);_this.addElement(background);_this.text=new basic_shapes_1.BasicText(35,765,"0,0");_this.addElement(_this.text);return _this}FloatBar.prototype.display=function(b){this.style=b?"floatBar active":"floatBar hidden"};FloatBar.prototype.setText=function(t){this.text.setText(t)};return FloatBar}(svg_elements_1.Group);exports.FloatBar=FloatBar},{"./basic-shapes":27,"./svg-elements":47}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var svg_node_object_1=require("./svg-node-object");exports.SvgNodeObject=svg_node_object_1.SvgNodeObject;var application_1=require("./application");exports.Application=application_1.Application;var selection_manager_1=require("./selection-manager");exports.SelectionManager=selection_manager_1.SelectionManager;var tool_manager_1=require("./tool-manager");exports.ToolManager=tool_manager_1.ToolManager;var float_bar_1=require("./float-bar");exports.FloatBar=float_bar_1.FloatBar;var svg_constants_1=require("./svg-constants");exports.SvgConstants=svg_constants_1.SvgConstants;var context_1=require("./svg-elements/context");exports.Context=context_1.Context;var grid_1=require("./svg-elements/grid");exports.Grid=grid_1.Grid;var group_1=require("./svg-elements/group");exports.Group=group_1.Group;var pattern_1=require("./svg-elements/pattern");exports.Pattern=pattern_1.Pattern;var control_point_1=require("./control-objects/control-point");exports.ControlPoint=control_point_1.ControlPoint;var control_object_1=require("./control-objects/control-object");exports.ControlObject=control_object_1.ControlObject;var polyline_control_1=require("./control-objects/polyline-control");exports.PolylineControl=polyline_control_1.PolylineControl;var polygon_control_1=require("./control-objects/polygon-control");exports.PolygonControl=polygon_control_1.PolygonControl;var rectangle_control_1=require("./control-objects/rectangle-control");exports.RectangleControl=rectangle_control_1.RectangleControl;var circle_control_1=require("./control-objects/circle-control");exports.CircleControl=circle_control_1.CircleControl;var three_point_circle_control_1=require("./control-objects/three-point-circle-control");exports.ThreePointCircleControl=three_point_circle_control_1.ThreePointCircleControl;var control_factory_1=require("./control-objects/control-factory");exports.ControlFactory=control_factory_1.ControlFactory;var control_modifier_1=require("./control-modifiers/control-modifier");exports.ControlModifier=control_modifier_1.ControlModifier;var orthogonal_modifier_1=require("./control-modifiers/orthogonal-modifier");exports.OrthogonalModifier=orthogonal_modifier_1.OrthogonalModifier;var grid_modifier_1=require("./control-modifiers/grid-modifier");exports.GridModifier=grid_modifier_1.GridModifier;var basic_line_1=require("./basic-shapes/basic-line");exports.BasicLine=basic_line_1.BasicLine;var basic_polygon_1=require("./basic-shapes/basic-polygon");exports.BasicPolygon=basic_polygon_1.BasicPolygon;var basic_polyline_1=require("./basic-shapes/basic-polyline");exports.BasicPolyline=basic_polyline_1.BasicPolyline;var basic_rectangle_1=require("./basic-shapes/basic-rectangle");exports.BasicRectangle=basic_rectangle_1.BasicRectangle;var basic_circle_1=require("./basic-shapes/basic-circle");exports.BasicCircle=basic_circle_1.BasicCircle;var basic_text_1=require("./basic-shapes/basic-text");exports.BasicText=basic_text_1.BasicText;var basic_path_1=require("./basic-shapes/basic-path");exports.BasicPath=basic_path_1.BasicPath},{"./application":19,"./basic-shapes/basic-circle":20,"./basic-shapes/basic-line":21,"./basic-shapes/basic-path":22,"./basic-shapes/basic-polygon":23,"./basic-shapes/basic-polyline":24,"./basic-shapes/basic-rectangle":25,"./basic-shapes/basic-text":26,"./control-modifiers/control-modifier":28,"./control-modifiers/grid-modifier":29,"./control-modifiers/orthogonal-modifier":30,"./control-objects/circle-control":31,"./control-objects/control-factory":32,"./control-objects/control-object":33,"./control-objects/control-point":34,"./control-objects/polygon-control":36,"./control-objects/polyline-control":37,"./control-objects/rectangle-control":38,"./control-objects/three-point-circle-control":39,"./float-bar":40,"./selection-manager":42,"./svg-constants":43,"./svg-elements/context":44,"./svg-elements/grid":45,"./svg-elements/group":46,"./svg-elements/pattern":48,"./svg-node-object":49,"./tool-manager":50}],42:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var basic_shapes_1=require("./basic-shapes");var svg_elements_1=require("./svg-elements");var SelectionManager=function(_super){__extends(SelectionManager,_super);function SelectionManager(){var _this=_super.call(this)||this;_this.selectedElement=null;_this.selectedElementListener=null;_this.drawBoundingBox=function(){_this.clear();if(_this.selectedElement!==null){var bb=_this.selectedElement.boundingBox;if(bb!==null&&!bb.isEmpty){var margin=14.5;var position=bb.min.clone().addScalar(-1*margin);var dimensions=bb.max.clone().sub(bb.min).addScalar(2*margin);var bbShape=new basic_shapes_1.BasicRectangle(position.x,position.y,dimensions.x,dimensions.y);_this.addElement(bbShape)}}};_this.baseStyle="boundingBox";return _this}Object.defineProperty(SelectionManager.prototype,"notNull",{get:function(){return this.selectedElement!==null},enumerable:true,configurable:true});SelectionManager.prototype.set=function(control){if(this.selectedElement){this.selectedElement.selected=false}if(this.selectedElementListener){this.selectedElementListener()}this.selectedElement=control;if(this.selectedElement){this.selectedElement.selected=true;this.selectedElementListener=this.selectedElement.subscribeToChanges(this.drawBoundingBox)}this.drawBoundingBox();this.notifyObservers()};SelectionManager.prototype.deleteElement=function(){if(this.selectedElement!==null){this.selectedElement.removeFromParent();this.set(null)}};return SelectionManager}(svg_elements_1.Group);exports.SelectionManager=SelectionManager},{"./basic-shapes":27,"./svg-elements":47}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SvgConstants={SVGNS:"http://www.w3.org/2000/svg",XLink:"http://www.w3.org/1999/xlink"}},{}],44:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var handle_1=require("@daign/handle");var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var Context=function(_super){__extends(Context,_super);function Context(container){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"svg");_this.baseStyle="context";_this.node.setAttribute("xmlns:xlink",svg_constants_1.SvgConstants.XLink);container.appendChild(_this.node);_this.setSize(1200,800);return _this}Context.prototype.addElement=function(element){this.node.appendChild(element.node)};Context.prototype.setSize=function(width,height){this.node.style.width=width+"px";this.node.style.height=height+"px";this.node.setAttribute("viewBox","0,0,"+width+","+height)};Context.prototype.setOnMouseDownAction=function(onMouseDown){var handle=new handle_1.Handle(this.node);handle.beginning=function(event){onMouseDown(event);return false}};return Context}(svg_node_object_1.SvgNodeObject);exports.Context=Context},{"../svg-constants":43,"../svg-node-object":49,"@daign/handle":4}],45:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var basic_shapes_1=require("../basic-shapes");var group_1=require("./group");var pattern_1=require("./pattern");var Grid=function(_super){__extends(Grid,_super);function Grid(){var _this=_super.call(this)||this;_this.baseStyle="grid";var rectangle=new basic_shapes_1.BasicRectangle(0,0,1200,800);_this.addElement(rectangle);var pattern=new pattern_1.Pattern("GridPattern",50,50);pattern.style="gridPattern";_this.addElement(pattern);var gridLine=new basic_shapes_1.BasicPath("M 50,0 L 0,0 0,50");pattern.addElement(gridLine);return _this}return Grid}(group_1.Group);exports.Grid=Grid},{"../basic-shapes":27,"./group":46,"./pattern":48}],46:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var Group=function(_super){__extends(Group,_super);function Group(){var _this=_super.call(this)||this;_this.node=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"g");_this.baseStyle="group";return _this}return Group}(svg_node_object_1.SvgNodeObject);exports.Group=Group},{"../svg-constants":43,"../svg-node-object":49}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var context_1=require("./context");exports.Context=context_1.Context;var grid_1=require("./grid");exports.Grid=grid_1.Grid;var group_1=require("./group");exports.Group=group_1.Group;var pattern_1=require("./pattern");exports.Pattern=pattern_1.Pattern},{"./context":44,"./grid":45,"./group":46,"./pattern":48}],48:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var svg_constants_1=require("../svg-constants");var svg_node_object_1=require("../svg-node-object");var Pattern=function(_super){__extends(Pattern,_super);function Pattern(id,width,height){var _this=_super.call(this)||this;var pattern=document.createElementNS(svg_constants_1.SvgConstants.SVGNS,"pattern");_this.node=pattern;pattern.setAttribute("x",String(0));pattern.setAttribute("y",String(0));pattern.setAttribute("width",String(width));pattern.setAttribute("height",String(height));pattern.setAttribute("id",id);pattern.setAttribute("patternUnits","userSpaceOnUse");_this.baseStyle="pattern";return _this}return Pattern}(svg_node_object_1.SvgNodeObject);exports.Pattern=Pattern},{"../svg-constants":43,"../svg-node-object":49}],49:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var observable_1=require("@daign/observable");var SvgNodeObject=function(_super){__extends(SvgNodeObject,_super);function SvgNodeObject(){var _this=_super.call(this)||this;_this.elements=[];_this.namedMapping={};_this.removeCallback=null;_this._baseStyle=null;_this._customStyle=null;_this._selected=false;return _this}Object.defineProperty(SvgNodeObject.prototype,"style",{set:function(styleName){this._customStyle=styleName;this.applyStyle()},enumerable:true,configurable:true});Object.defineProperty(SvgNodeObject.prototype,"selected",{set:function(b){this._selected=b;this.applyStyle()},enumerable:true,configurable:true});Object.defineProperty(SvgNodeObject.prototype,"baseStyle",{set:function(styleName){this._baseStyle=styleName;this.applyStyle()},enumerable:true,configurable:true});SvgNodeObject.prototype.addElement=function(element,name){var _this=this;this.elements.push(element);this.node.appendChild(element.node);if(name){this.namedMapping[name]=element}var remove=function(){_this.removeElement(element,name)};element.setRemoveCallback(remove)};SvgNodeObject.prototype.removeElement=function(element,name){this.node.removeChild(element.node);var index=this.elements.indexOf(element);if(index>-1){this.elements.splice(index,1)}if(name){delete this.namedMapping[name]}};SvgNodeObject.prototype.clear=function(){while(this.node.firstChild){this.node.removeChild(this.node.firstChild)}this.elements=[];this.namedMapping={}};SvgNodeObject.prototype.setRemoveCallback=function(remove){this.removeCallback=remove};SvgNodeObject.prototype.removeFromParent=function(){if(this.removeCallback!==null){this.removeCallback();this.removeCallback=null}this.clearObservers()};SvgNodeObject.prototype.getElementByName=function(name){return this.namedMapping[name]};SvgNodeObject.prototype.applyStyle=function(){var styles=[this._baseStyle,this._customStyle,this._selected?"selected":null];var styleString=styles.filter(function(s){return s!==null}).join(" ");this.node.setAttribute("class",styleString)};return SvgNodeObject}(observable_1.Observable);exports.SvgNodeObject=SvgNodeObject},{"@daign/observable":15}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ToolManager=function(){function ToolManager(selectionManager,controlFactory,floatBar){this.activeToolName=null;this.workingLayer=null;this.selectionManager=selectionManager;this.controlFactory=controlFactory;this.floatBar=floatBar}ToolManager.prototype.setTool=function(toolName){this.activeToolName=toolName};ToolManager.prototype.setWorkingLayer=function(layer){this.workingLayer=layer};ToolManager.prototype.globalAction=function(position){var _this=this;this.floatBar.setText(position.x+", "+position.y);this.floatBar.display(true);var activeElement=this.selectionManager.selectedElement;if(this.workingLayer!==null&&this.activeToolName!==null){if(activeElement===null){activeElement=this.controlFactory.createControl(this.activeToolName);activeElement.addPoint(position);this.workingLayer.addElement(activeElement);this.selectionManager.set(activeElement)}else{activeElement.addPoint(position)}if(activeElement.drawingFinished){this.selectionManager.set(null)}}setTimeout(function(){_this.floatBar.display(false)},1e3)};return ToolManager}();exports.ToolManager=ToolManager},{}]},{},[2]);
